

$SqlAGCentral = "CentralCTXAG1"
$SqlAGEast = "EastUS2CTXAG1"




[System.Reflection.Assembly]::LoadWithPartialName("Microsoft.SqlServer.Smo") |

Out-Null


$SqlServerCentral1 = New-Object Microsoft.SqlServer.Management.Smo.Server("SQL-CENTRALUS1")

$SqlServerCentral1.AvailabilityGroups[$SqlAGCentral].AvailabilityReplicas |

  Where-Object {$_.Name -eq $SqlServerCentral1.Name} |

  Select-Object Name,

    #Role,

    #OperationalState,

    ConnectionState


$SqlServerCentral2 = New-Object Microsoft.SqlServer.Management.Smo.Server("SQL-CENTRALUS2")

$SqlServerCentral2.AvailabilityGroups[$SqlAGCentral].AvailabilityReplicas |

  Where-Object {$_.Name -eq $SqlServerCentral2.Name} |

  Select-Object Name,

    #Role,

    #OperationalState,

    ConnectionState


$SqlServerEast1 = New-Object Microsoft.SqlServer.Management.Smo.Server("SQL-EASTUS2-1")

$SqlServerEast1.AvailabilityGroups["EastUS2CTXAG1"].AvailabilityReplicas |

  Where-Object {$_.Name -eq $SqlServerEast1.Name} |

  Select-Object Name,

    #Role,

    #OperationalState,

    ConnectionState


$SqlServerEast2 = New-Object Microsoft.SqlServer.Management.Smo.Server("SQL-EASTUS2-2")

$SqlServerEast2.AvailabilityGroups["EastUS2CTXAG1"].AvailabilityReplicas |

  Where-Object {$_.Name -eq $SqlServerEast2.Name} |

  Select-Object Name,

    #Role,

    #OperationalState,

    ConnectionState
